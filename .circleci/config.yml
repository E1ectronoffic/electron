version: 2.1

# required for dynamic configuration feature
setup: true
# setup: << pipeline.parameters.run-setup >>

orbs:
  path-filtering: circleci/path-filtering@0.0.3

# initial setup workflow
workflows:
  setup:
    # when: << pipeline.parameters.run-setup >>
    jobs:
      - path-filtering/filter:
          # Compare files on all branches, using the webhook payload from Github
          base-revision: << pipeline.git.branch >>
          # config-path: .circleci/config.yml
          # Params for mapping; `path-to-test parameter-to-set value-for-parameter` for each row
          mapping: |
            .* run-lint true
            ^((?!docs/).)*$ run-build-mac true
            ^((?!docs/).)*$ run-build-linux true
            docs/.* run-docs-only true
          config-path: .circleci/build_config.yml
