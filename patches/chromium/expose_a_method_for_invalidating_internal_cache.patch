From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: emmanuel.kimmerlin@thomsonreuters.com <emmanuel.kimmerlin@thomsonreuters.com>
Date: Mon, 18 Nov 2019 12:42:23 +0100
Subject: Expose a method for invalidating internal cache

Allow to customize Electron/Chromium cache location
See MR: https://github.com/electron/electron/pull/19693

diff --git a/base/path_service.cc b/base/path_service.cc
index 8b05f150b3604d16aa96e63417c51bfdd9661bef..46f8680ec14328e4c4e3a3abc24f28df4e79fdcd 100644
--- a/base/path_service.cc
+++ b/base/path_service.cc
@@ -326,6 +326,15 @@ void PathService::RegisterProvider(ProviderFunc func, int key_start,
   path_data->providers = p;
 }
 
+// static
+void PathService::InvalidateCache() {
+  PathData * path_data = GetPathData();
+  DCHECK(path_data);
+
+  AutoLock scoped_lock(path_data->lock);
+  path_data->cache.clear();
+}
+
 // static
 void PathService::DisableCache() {
   PathData* path_data = GetPathData();
diff --git a/base/path_service.h b/base/path_service.h
index 753bbf131e908906039eb6d73e9999de4159899a..411aeddce024465350d7277ad22191901164dc97 100644
--- a/base/path_service.h
+++ b/base/path_service.h
@@ -75,6 +75,9 @@ class BASE_EXPORT PathService {
   // Disable internal cache.
   static void DisableCache();
 
+  // Clear cache
+  static void InvalidateCache();
+
  private:
   friend class ScopedPathOverride;
   FRIEND_TEST_ALL_PREFIXES(PathServiceTest, RemoveOverride);
